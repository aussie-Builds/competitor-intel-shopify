<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Competitor Intel</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;450;500;550;600;650;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/css/styles.css">
</head>
<body>
  <div class="container">
    <header>
      <div class="header-main">
        <h1>Competitor Intel</h1>
        <p class="subtitle">AI-Powered Competitive Monitoring</p>
      </div>
      <div class="user-menu" id="user-menu">
        <div class="user-info" id="user-info">
          <span class="user-plan" id="user-plan">Starter</span>
          <span class="user-name" id="user-name"></span>
          <button class="user-menu-btn" onclick="toggleUserDropdown()">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/></svg>
          </button>
        </div>
        <div class="user-dropdown" id="user-dropdown">
          <a href="/pricing" class="dropdown-item">Manage Plan</a>
          <a href="#" class="dropdown-item" onclick="openBillingPortal(); return false;" id="billing-link">Billing</a>
          <hr class="dropdown-divider">
          <a href="#" class="dropdown-item" onclick="logout(); return false;">Log Out</a>
        </div>
      </div>
    </header>

    <div class="usage-bar" id="usage-bar">
      <div class="usage-item">
        <span class="usage-label">Competitors:</span>
        <span class="usage-value" id="usage-competitors">0/3</span>
      </div>
      <div class="usage-item">
        <span class="usage-label">Pages/competitor:</span>
        <span class="usage-value" id="usage-pages">5 max</span>
      </div>
      <div class="usage-item">
        <span class="usage-label">Checks:</span>
        <span class="usage-value" id="usage-frequency">Daily</span>
      </div>
      <a href="/pricing" class="upgrade-link" id="upgrade-link">Upgrade Plan</a>
    </div>

    <div class="stats-bar" id="stats-bar">
      <div class="stat">
        <span class="stat-value" id="stat-competitors">-</span>
        <span class="stat-label">Competitors</span>
      </div>
      <div class="stat">
        <span class="stat-value" id="stat-pages">-</span>
        <span class="stat-label">Pages</span>
      </div>
      <div class="stat">
        <span class="stat-value" id="stat-changes-24h">-</span>
        <span class="stat-label">Changes (24h)</span>
      </div>
      <div class="stat">
        <span class="stat-value" id="stat-changes-7d">-</span>
        <span class="stat-label">Changes (7d)</span>
      </div>
    </div>

    <div class="actions">
      <button class="btn btn-primary" onclick="openAddModal()">+ Add Competitor</button>
      <button class="btn btn-secondary" onclick="checkAll()">Check All Now</button>
    </div>

    <section class="section">
      <h2>Monitored Competitors</h2>
      <div id="competitors-list" class="competitors-list"></div>
    </section>

    <section class="section">
      <h2>Recent Changes</h2>
      <div id="changes-list" class="changes-list"></div>
    </section>
  </div>

  <!-- Add Competitor Modal -->
  <div id="add-modal" class="modal">
    <div class="modal-content modal-large">
      <span class="close" onclick="closeAddModal()">&times;</span>
      <h2>Add Competitor</h2>
      <form id="add-form" onsubmit="addCompetitor(event)">
        <div class="form-group">
          <label for="comp-name">Competitor Name</label>
          <input type="text" id="comp-name" name="name" required placeholder="e.g., Acme Corp">
        </div>

        <div class="form-group">
          <label for="base-url">Base URL</label>
          <input type="url" id="base-url" name="baseUrl" required placeholder="https://example.com">
        </div>

        <div class="form-group">
          <label>Quick Add Pages</label>
          <div class="quick-add-grid" id="quick-add-buttons"></div>
        </div>

        <div class="form-group">
          <label>Pages to Monitor</label>
          <div id="pages-list" class="pages-input-list"></div>
          <button type="button" class="btn btn-secondary btn-small" onclick="addPageInput()">+ Add Custom Page</button>
        </div>

        <button type="submit" class="btn btn-primary">Add Competitor</button>
      </form>
    </div>
  </div>

  <!-- Add Page Modal (for existing competitors) -->
  <div id="add-page-modal" class="modal">
    <div class="modal-content">
      <span class="close" onclick="closeAddPageModal()">&times;</span>
      <h2>Add Page</h2>
      <p class="modal-subtitle" id="add-page-competitor-name"></p>
      <form id="add-page-form" onsubmit="addPageToCompetitor(event)">
        <input type="hidden" id="add-page-competitor-id">

        <div class="form-group">
          <label>Quick Add</label>
          <div class="quick-add-grid" id="quick-add-page-buttons"></div>
        </div>

        <div class="form-group">
          <label for="page-url">Page URL</label>
          <input type="url" id="page-url" name="url" required placeholder="https://example.com/pricing">
        </div>
        <div class="form-group">
          <label for="page-label">Label</label>
          <input type="text" id="page-label" name="label" placeholder="e.g., Pricing">
        </div>
        <button type="submit" class="btn btn-primary">Add Page</button>
      </form>
    </div>
  </div>

  <!-- Change Detail Modal -->
  <div id="change-modal" class="modal">
    <div class="modal-content modal-large">
      <span class="close" onclick="closeChangeModal()">&times;</span>
      <div id="change-detail"></div>
    </div>
  </div>

  <script src="/js/app.js"></script>
</body>
</html>
